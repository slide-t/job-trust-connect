<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JobTrust Connect â€” Application</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background: #121212;
    color: #fff;
    transition: background 0.3s, color 0.3s;
  }
  header {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 15px;
    background: #1e1e1e;
    font-size: 1.5em;
  }
  header i { font-style: normal; }
  .container {
    max-width: 900px;
    margin: auto;
    padding: 20px;
  }
  label { display: block; margin-top: 10px; }
  input, select, textarea {
    width: 100%; padding: 8px; margin-top: 5px;
    border: 1px solid #555; border-radius: 4px;
    background: #222; color: #fff;
  }
  button {
    padding: 10px 20px; margin-top: 15px; cursor: pointer;
    background: teal; color: white; border: none; border-radius: 4px;
  }
  #darkToggle {
    position: fixed; left: 10px; top: 50%; transform: translateY(-50%);
    background: #444; padding: 10px; border-radius: 50%; cursor: pointer;
  }
  .light-mode { background: #fff; color: #000; }
  .light-mode input, .light-mode select, .light-mode textarea {
    background: #f2f2f2; color: #000;
  }
  #photoPreview { display: block; max-width: 150px; margin-top: 10px; }
  #livePreview { margin-top: 20px; border: 1px solid #555; padding: 10px; }
  /* Modal */
  .modal {
    display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(255,255,255,0.7); justify-content: center; align-items: center;
  }
  .modal-content {
    background: #fff; color: #000; padding: 20px; border-radius: 8px; max-width: 400px; width: 100%;
  }
  .close {
    position: absolute; right: 10px; top: 10px; cursor: pointer; font-size: 18px;
  }
</style>
</head>
<body>
<div id="darkToggle">ðŸŒ“</div>
<header>
  <i>ðŸ’¼</i> JobTrust Connect
</header>
<div class="container">
  <p><strong>Instructions:</strong> Please complete all required fields. Review your details before submitting.</p>
  <form id="jobForm">
    <label>Applicant Photo (Preview only)</label>
    <input type="file" accept="image/*" id="photoUpload">
    <img id="photoPreview">

    <label>Full Name</label>
    <input type="text" name="fullName" required>

    <label>Email</label>
    <input type="email" name="email" required>

    <label>Phone</label>
    <input type="tel" name="phone" required>

    <label>Address</label>
    <textarea name="address" required></textarea>

    <label>Date of Birth</label>
    <input type="date" id="dob" required>
    <label>Age</label>
    <input type="text" id="age" readonly>

    <label>Gender</label>
    <select name="gender" required>
      <option value="">Select...</option>
      <option>Male</option>
      <option>Female</option>
    </select>

    <label>Marital Status</label>
    <select name="maritalStatus" required>
      <option value="">Select...</option>
      <option>Single</option>
      <option>Married</option>
    </select>

    <label>State of Origin</label>
    <select id="stateOrigin" required>
      <option value="">Select state</option>
      <option>Abia</option><option>Adamawa</option><option>Akwa Ibom</option>
      <option>Anambra</option><option>Bauchi</option><option>Bayelsa</option>
      <option>Benue</option><option>Borno</option><option>Cross River</option>
      <option>Delta</option><option>Ebonyi</option><option>Edo</option>
      <option>Ekiti</option><option>Enugu</option><option>FCT</option>
      <option>Gombe</option><option>Imo</option><option>Jigawa</option>
      <option>Kaduna</option><option>Kano</option><option>Katsina</option>
      <option>Kebbi</option><option>Kogi</option><option>Kwara</option>
      <option>Lagos</option><option>Nasarawa</option><option>Niger</option>
      <option>Ogun</option><option>Ondo</option><option>Osun</option>
      <option>Oyo</option><option>Plateau</option><option>Rivers</option>
      <option>Sokoto</option><option>Taraba</option><option>Yobe</option>
      <option>Zamfara</option>
    </select>

    <label>LGA</label>
    <input type="text" id="lga" required>

    <label>Parent Name</label>
    <input type="text" name="parentName" required>

    <label>Parent Phone</label>
    <input type="tel" name="parentPhone" required>
    
    <label>Parent Address</label>
    <textarea name="parentAddress" required></textarea>

    <label>Guarantor Name</label>
    <input type="text" name="guarantorName" required>

    <label>Guarantor Phone</label>
    <input type="tel" name="guarantorPhone" required>

    <label>Guarantor Address</label>
    <textarea name="guarantorAddress" required></textarea>

    <label for="parentRelationship">Relationship with Guarantor</label>
<select name="parentRelationship" id="parentRelationship" required>
  <option value="">-- Select Relationship --</option>
  <option value="Father">Father</option>
  <option value="Mother">Mother</option>
  <option value="Elder Sister">Elder Sister</option>
  <option value="Elder Brother">Elder Brother</option>
  <option value="Aunt">Aunt</option>
  <option value="Cousin">Cousin</option>
  <option value="Uncle">Uncle</option>
</select>
    <label> Guarantor Age</label>
    <input type="text" name="parentRelationship" required>
    
    <label>Position Applied For</label>
    <select id="position" required>
      <option value="">Select...</option>
      <option>Care-giver</option>
      <option>Educator</option>
      <option>Marketer</option>
      <option>Other</option>
    </select>
    <input type="text" id="otherPosition" style="display:none" placeholder="Enter other position">

    <div id="livePreview"></div>
    <button type="button" id="printPdf">Print / Save PDF</button>
    <button type="submit">Submit</button>
  </form>
</div>

<!-- Subscription Modal -->
<div id="subModal" class="modal">
  <div class="modal-content">
    <span class="close" id="closeModal">&times;</span>
    <h3>Subscribe to our Newsletter</h3>
    <form id="subForm">
      <label>Name</label>
      <input type="text" name="userName" required>
      <label>Email</label>
      <input type="email" name="email" required>
      <label>Mobile Number</label>
      <input type="tel" name="mobileNumber" required>
      <label>Facebook</label>
      <input type="text" name="facebook" required>
      <button type="submit">Subscribe</button>
    </form>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
const jobSheet = "https://sheetdb.io/api/v1/v7ewb4v3x7zwa";
const subSheet = "https://sheetdb.io/api/v1/79zrc41hpxaer";

// Dark Mode Toggle
document.getElementById('darkToggle').onclick = () => {
  document.body.classList.toggle('light-mode');
};

// Photo Preview
document.getElementById('photoUpload').addEventListener('change', e => {
  const file = e.target.files[0];
  if(file) {
    const reader = new FileReader();
    reader.onload = () => document.getElementById('photoPreview').src = reader.result;
    reader.readAsDataURL(file);
  }
});

// Age Calculation
document.getElementById('dob').addEventListener('change', e => {
  const dob = new Date(e.target.value);
  const age = new Date().getFullYear() - dob.getFullYear();
  document.getElementById('age').value = age;
});

// Position Other Field
document.getElementById('position').addEventListener('change', e => {
  document.getElementById('otherPosition').style.display = e.target.value === "Other" ? "block" : "none";
});

// Live Preview
document.querySelectorAll('#jobForm input, #jobForm textarea, #jobForm select').forEach(el => {
  el.addEventListener('input', () => {
    const data = new FormData(document.getElementById('jobForm'));
    let html = "<h4>Live Preview</h4>";
    for (let [key, val] of data.entries()) { html += `<p><strong>${key}:</strong> ${val}</p>`; }
    document.getElementById('livePreview').innerHTML = html;
  });
});

// Print PDF
document.getElementById('printPdf').onclick = () => {
  html2canvas(document.getElementById('livePreview')).then(canvas => {
    const imgData = canvas.toDataURL('image/png');
    const pdf = new jspdf.jsPDF();
    pdf.addImage(imgData, 'PNG', 10, 10);
    pdf.save("preview.pdf");
  });
};

// Job Form Submit
document.getElementById('jobForm').onsubmit = e => {
  e.preventDefault();
  const data = {
    fullName: e.target.fullName.value,
    email: e.target.email.value,
    phone: e.target.phone.value,
    address: e.target.address.value,
    dob: e.target.dob.value,
    age: document.getElementById('age').value,
    gender: e.target.gender.value,
    maritalStatus: e.target.maritalStatus.value,
    parentName: e.target.parentName.value,
    parentPhone: e.target.parentPhone.value,
    parentRelationship: e.target.parentRelationship.value,
    parentAddress: e.target.parentAddress.value,
    guarantorName: e.target.guarantorName.value,
    guarantorPhone: e.target.guarantorPhone.value,
    guarantorAddress: e.target.guarantorAddress.value
  };
  fetch(jobSheet, {
    method: 'POST', headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ data: [data] })
  }).then(res => {
    if(res.ok) document.getElementById('subModal').style.display = 'flex';
  });
};

// Subscription Form Submit
document.getElementById('subForm').onsubmit = e => {
  e.preventDefault();
  const subData = Object.fromEntries(new FormData(e.target).entries());
  fetch(subSheet, {
    method: 'POST', headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ data: [subData] })
  }).then(res => window.location.href = "index.html");
};
document.getElementById('closeModal').onclick = () => window.location.href = "index.html";
</script>
</body>
</html>
