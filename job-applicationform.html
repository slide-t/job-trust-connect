<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JobTrust Connect - Application</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<style>
  body {
    font-family: Arial, sans-serif;
    background: #121212;
    color: #f5f5f5;
    margin: 0;
    padding: 20px;
    transition: background 0.3s, color 0.3s;
  }
  body.light-mode {
    background: #f9f9f9;
    color: #333;
  }
  .application-form {
    max-width: 700px;
    margin: auto;
    background: #1e1e1e;
    color: #f5f5f5;
    padding: 25px;
    border-radius: 8px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    transition: background 0.3s, color 0.3s;
  }
  body.light-mode .application-form {
    background: #fff;
    color: #333;
  }
  .application-form h2 {
    text-align: center;
    margin-bottom: 10px;
  }
  .instructions {
    font-size: 14px;
    text-align: center;
    margin-bottom: 20px;
    opacity: 0.9;
  }
  label {
    font-weight: bold;
    display: block;
    margin-top: 12px;
  }
  input, select, textarea {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
    border: 1px solid #555;
    border-radius: 5px;
    background: #2a2a2a;
    color: #f5f5f5;
    transition: background 0.3s, border 0.3s, color 0.3s;
  }
  body.light-mode input,
  body.light-mode select,
  body.light-mode textarea {
    background: #fff;
    color: #000;
    border: 1px solid #ccc;
  }
  textarea { resize: vertical; }
  button {
    margin-top: 20px;
    width: 100%;
    padding: 12px;
    background: #0077cc;
    color: #fff;
    border: none;
    font-size: 16px;
    cursor: pointer;
    border-radius: 5px;
    transition: background 0.3s;
  }
  button:hover {
    background: #005fa3;
  }

  /* Dark Mode Toggle Button */
  .dark-toggle {
    position: fixed;
    left: -60px;
    top: 50%;
    transform: translateY(-50%);
    background: #0077cc;
    color: white;
    padding: 10px 15px;
    border-radius: 0 8px 8px 0;
    cursor: pointer;
    transition: left 0.4s ease;
    z-index: 1000;
  }
  .dark-toggle.show {
    left: 0;
  }
  .dark-toggle:hover {
    background: #005fa3;
  }

  /* Modal Preview */
  .modal {
    display: none;
    position: fixed;
    z-index: 2000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background: rgba(0,0,0,0.8);
    padding: 20px;
  }
  .modal-content {
    background: #1e1e1e;
    padding: 20px;
    max-width: 700px;
    margin: auto;
    border-radius: 8px;
    color: #f5f5f5;
  }
  body.light-mode .modal-content {
    background: #fff;
    color: #333;
  }
</style>
</head>
<body>

<!-- Dark Mode Toggle -->
<div class="dark-toggle" id="darkToggle"><i class="fas fa-adjust"></i></div>

<div class="application-form">
  <h2><i class="fas fa-briefcase"></i> JobTrust Connect</h2>
  <div class="instructions">
    Please fill out all fields carefully. Review your application in the live preview before final submission.
  </div>
  <label for="applicantPhoto">Upload Applicant Photo</label>
<input type="file" id="applicantPhoto" accept="image/*" required>
<div id="photoPreview" style="margin-top:8px;">
  <img id="photoPreviewImg" src="" alt="Photo Preview" style="max-width:150px; display:none; border-radius:8px;">
</div>

  <form id="jobForm">
    <label>Full Name</label>
    <input type="text" name="full_name" required>

    <label>Email Address</label>
    <input type="email" name="email" required>
<label>Date of Birth</label>
<input type="date" id="dob" required>
<small id="ageDisplay" style="color:#555;display:block;margin-top:5px;">Age: —</small>

    <label>Phone Number</label>
    <input type="tel" name="phone" required>

    <label>Address</label>
    <input type="text" name="address" required>
<label for="position">Position Applied For</label>
<select id="position" name="position" required>
  <option value="">-- Select Position --</option>
  <option value="Care-giver">Care-giver</option>
  <option value="Educator">Educator</option>
  <option value="Marketer">Marketer</option>
  <option value="Other">Other</option>
</select>

<div id="otherPositionWrapper" style="display:none; margin-top:8px;">
  <input type="text" id="otherPosition" name="otherPosition" placeholder="Please specify position">
</div>

    <label>Education Background</label>
    <textarea name="education" rows="3" required></textarea>
     <label for="stateOfOrigin">State of Origin</label>
<select id="stateOfOrigin" name="stateOfOrigin" required>
  <option value="">-- Select State --</option>
  <option value="Abia">Abia</option>
  <option value="Adamawa">Adamawa</option>
  <option value="Akwa Ibom">Akwa Ibom</option>
  <option value="Anambra">Anambra</option>
  <option value="Bauchi">Bauchi</option>
  <option value="Bayelsa">Bayelsa</option>
  <option value="Benue">Benue</option>
  <option value="Borno">Borno</option>
  <option value="Cross River">Cross River</option>
  <option value="Delta">Delta</option>
  <option value="Ebonyi">Ebonyi</option>
  <option value="Edo">Edo</option>
  <option value="Ekiti">Ekiti</option>
  <option value="Enugu">Enugu</option>
  <option value="FCT">Federal Capital Territory</option>
  <option value="Gombe">Gombe</option>
  <option value="Imo">Imo</option>
  <option value="Jigawa">Jigawa</option>
  <option value="Kaduna">Kaduna</option>
  <option value="Kano">Kano</option>
  <option value="Katsina">Katsina</option>
  <option value="Kebbi">Kebbi</option>
  <option value="Kogi">Kogi</option>
  <option value="Kwara">Kwara</option>
  <option value="Lagos">Lagos</option>
  <option value="Nasarawa">Nasarawa</option>
  <option value="Niger">Niger</option>
  <option value="Ogun">Ogun</option>
  <option value="Ondo">Ondo</option>
  <option value="Osun">Osun</option>
  <option value="Oyo">Oyo</option>
  <option value="Plateau">Plateau</option>
  <option value="Rivers">Rivers</option>
  <option value="Sokoto">Sokoto</option>
  <option value="Taraba">Taraba</option>
  <option value="Yobe">Yobe</option>
  <option value="Zamfara">Zamfara</option>
</select>

<label for="lga">Local Government Area (LGA)</label>
<input type="text" id="lga" name="lga" placeholder="Enter your LGA" required>

    <label>Work Experience</label>
    <textarea name="experience" rows="3" required></textarea>

    <label>Skills & Competencies</label>
    <textarea name="skills" rows="2" required></textarea>

    <label>References</label>
    <textarea name="references" rows="3" placeholder="input name of guarantor and active mobile number" required></textarea>
     
    <label>Available Start Date</label>
    <input type="date" name="availability" required>

    <label>Resume Link (optional)</label>
    <input type="url" name="resume">

    <label>
      <input type="checkbox" name="consent" required>
      I confirm that the information provided is accurate.
    </label>

    <button type="button" id="previewBtn">Preview Application</button>
  </form>
</div>

<!-- Modal for Preview -->
<div id="previewModal" class="modal">
  <div class="modal-content" id="modalContent">
    <h3>Application Preview</h3>
    <div id="previewData"></div>
    <button id="printPdf">Print as PDF</button>
    <button id="submitFinal">Submit Application</button>
  </div>
</div>

<!-- Scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
  // Toggle Button Animation
  window.addEventListener("load", () => {
    document.getElementById("darkToggle").classList.add("show");
  });

  // Dark Mode Toggle
  document.getElementById("darkToggle").addEventListener("click", () => {
    document.body.classList.toggle("light-mode");
  });

  const previewModal = document.getElementById("previewModal");
  const previewData = document.getElementById("previewData");
  
  document.getElementById("previewBtn").addEventListener("click", () => {
    const form = document.getElementById("jobForm");
    if (!form.checkValidity()) {
      form.reportValidity();
      return;
    }
    let html = "";
    [...new FormData(form).entries()].forEach(([key, value]) => {
      if (key !== "consent") {
        html += `<p><strong>${key.replace(/_/g, ' ')}:</strong> ${value}</p>`;
      }
    });
    previewData.innerHTML = html;
    previewModal.style.display = "block";
  });

  // Print PDF
  document.getElementById("printPdf").addEventListener("click", () => {
    html2canvas(document.getElementById("modalContent")).then(canvas => {
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF();
      pdf.addImage(canvas.toDataURL("image/png"), "PNG", 10, 10, 190, 0);
      pdf.save("application_preview.pdf");
    });
  });
/*
  // Submit to SheetDB
  document.getElementById("submitFinal").addEventListener("click", () => {
    const formData = new FormData(document.getElementById("jobForm"));
    const data = {};
    formData.forEach((value, key) => data[key] = value);

    fetch("https://sheetdb.io/api/v1/v7ewb4v3x7zwa", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ data: [data] })
    })
    .then(res => res.json())
    .then(() => {
      alert("Application submitted successfully!");
      previewModal.style.display = "none";
      document.getElementById("jobForm").reset();
    })
    .catch(() => alert("Error submitting application."));
  });

  form.addEventListener("submit", function(e) {
  e.preventDefault();

  if (!form.checkValidity()) {
    form.reportValidity();
    return;
  }

  fetch(form.action, {
    method: "POST",
    body: new FormData(form)
  })
  .then(response => {
    if (response.ok) {
      alert("Form submitted successfully!");
      window.location.href = "index.html"; // Redirect here
    } else {
      alert("Error submitting the form. Please try again.");
    }
  })
  .catch(error => {
    alert("Submission failed. Please check your network and try again.");
    console.error("Error:", error);
  });
});
*/

  // Close modal on click outside
  window.onclick = function(e) {
    if (e.target == previewModal) {
      previewModal.style.display = "none";
    }
  }
  // Auto-calculate age
document.getElementById("dob").addEventListener("change", function() {
  const dob = new Date(this.value);
  if (isNaN(dob)) {
    document.getElementById("ageDisplay").textContent = "Age: —";
    return;
  }

  const today = new Date();
  let age = today.getFullYear() - dob.getFullYear();
  const monthDiff = today.getMonth() - dob.getMonth();
  if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < dob.getDate())) {
    age--;
  }

  document.getElementById("ageDisplay").textContent = `Age: ${age} years`;
});
  document.getElementById('position').addEventListener('change', function() {
  const otherWrapper = document.getElementById('otherPositionWrapper');
  if (this.value === 'Other') {
    otherWrapper.style.display = 'block';
    document.getElementById('otherPosition').setAttribute('required', 'required');
  } else {
    otherWrapper.style.display = 'none';
    document.getElementById('otherPosition').removeAttribute('required');
    document.getElementById('otherPosition').value = '';
  }
});
document.getElementById('applicantPhoto').addEventListener('change', function(event) {
  const file = event.target.files[0];
  if (file) {
    const reader = new FileReader();
    reader.onload = function(e) {
      const img = document.getElementById('photoPreviewImg');
      img.src = e.target.result;
      img.style.display = 'block';
    };
    reader.readAsDataURL(file);
  }
});


</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const form = document.getElementById("jobForm");

  form.addEventListener("submit", function (e) {
    e.preventDefault();

    if (!form.checkValidity()) {
      form.reportValidity();
      return;
    }

    fetch(form.action, {
      method: "POST",
      body: new FormData(form)
    })
    .then(response => {
      if (response.ok) {
        alert("Form submitted successfully!");
        window.location.href = "index.html"; // Redirect to home page
      } else {
        alert("Error submitting the form. Please try again.");
      }
    })
    .catch(error => {
      alert("Submission failed. Please check your network and try again.");
      console.error("Error:", error);
    });
  });
});
</script>

  
</body>
</html>
